---
- name: PostgreSQL | Extensions | PgAudit | Get information about installed packages as facts
  package_facts:
    manager: auto
  when: ansible_facts.packages is undefined

- name: PostgreSQL | Extensions | PgAudit | Install package(s) for PostgreSQL {{ new_version.pg.version }}
  when: ansible_facts.packages[old_version.pgaudit.package_name[ansible_os_family]] is defined
  package:
    name: "{{ _packages[ansible_os_family] }}"
    state: present
  vars:
    _packages:
      Debian: "{{ new_version.pgaudit.package_name.Debian }}={{ new_version.pgaudit.version.Debian + '-*' }}"
      RedHat: "{{ new_version.pgaudit.package_name.RedHat }}-{{ new_version.pgaudit.version.RedHat }}"
  module_defaults:
    yum: { lock_timeout: "{{ yum_lock_timeout }}" }
