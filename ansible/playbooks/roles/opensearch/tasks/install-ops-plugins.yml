---
- name: Install opensearch-* packages
  package:
    name: "{{ _packages[ansible_os_family] }}"
    state: present
  vars:
    _packages:
      Debian:
        - opensearch-alerting={{ versions[ansible_os_family].ops_version }}
        - opensearch-index-management={{ versions[ansible_os_family].ops_version }}
        - opensearch-job-scheduler={{ versions[ansible_os_family].ops_version }}
        - opensearch-performance-analyzer={{ versions[ansible_os_family].ops_version }}
        - opensearch-security={{ versions[ansible_os_family].ops_version }}
        - opensearch-sql={{ versions[ansible_os_family].ops_version }}
      RedHat:
        - opensearch-alerting-{{ versions[ansible_os_family].ops_version }}
        - opensearch-index-management-{{ versions[ansible_os_family].ops_version }}
        - opensearch-job-scheduler-{{ versions[ansible_os_family].ops_version }}
        - opensearch-performance-analyzer-{{ versions[ansible_os_family].ops_version }}
        - opensearch-security-{{ versions[ansible_os_family].ops_version }}
        - opensearch-sql-{{ versions[ansible_os_family].ops_version }}
  register: install_opensearch_packages
  module_defaults:
    yum: { lock_timeout: "{{ yum_lock_timeout }}" }
