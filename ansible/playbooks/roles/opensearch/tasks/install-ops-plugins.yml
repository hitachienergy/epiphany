---
# NOTE: Keep in mind compatibility matrix for Open Distro https://opendistro.github.io/for-elasticsearch-docs/docs/install/plugins/#plugin-compatibility
- name: Install opensearch-* packages
  package:
    name: "{{ _packages[ansible_os_family] }}"
    state: present
  vars:
    _packages:
      Debian:
        - opensearch-alerting={{ versions[ansible_os_family].opendistro }}
        - opensearch-index-management={{ versions[ansible_os_family].opendistro }}
        - opensearch-job-scheduler={{ versions[ansible_os_family].opendistro }}
        - opensearch-performance-analyzer={{ versions[ansible_os_family].opendistro }}
        - opensearch-security={{ versions[ansible_os_family].opendistro }}
        - opensearch-sql={{ versions[ansible_os_family].opendistro }}
      RedHat:
        - opensearch-alerting-{{ versions[ansible_os_family].opendistro }}
        - opensearch-index-management-{{ versions[ansible_os_family].opendistro }}
        - opensearch-job-scheduler-{{ versions[ansible_os_family].opendistro }}
        - opensearch-performance-analyzer-{{ versions[ansible_os_family].opendistro }}
        - opensearch-security-{{ versions[ansible_os_family].opendistro }}
        - opensearch-sql-{{ versions[ansible_os_family].opendistro }}
  register: install_opendistro_packages
  module_defaults:
    yum: { lock_timeout: "{{ yum_lock_timeout }}" }
