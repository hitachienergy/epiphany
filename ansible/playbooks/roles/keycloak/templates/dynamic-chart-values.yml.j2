#jinja2: lstrip_blocks: True

# Keep data structure in sync with Helm chart's values.
# ref: https://raw.githubusercontent.com/codecentric/helm-charts/keycloakx-1.6.0/charts/keycloakx/values.yaml

{% if specification.image_registry.use_local %}
image:
  repository: {{ image_registry_address }}/{{ _chart_values.image.repository }}
{% else %}
image:
  repository: {{ _chart_values.image.repository }}
{% endif %}

# TODO: hostname as variable
{% if specification.database.epiphany_managed and _chart_values.database.hostname == 'AUTOCONFIGURED' %}
database:
  {% if groups.postgresql | count == 1 %}
  hostname: {{ hostvars[groups.postgresql[0]].ansible_default_ipv4.address }}
  {% else %}
  hostname: pgbouncer.postgres-pool.svc.cluster.local
  {% endif %}
{% endif %}
