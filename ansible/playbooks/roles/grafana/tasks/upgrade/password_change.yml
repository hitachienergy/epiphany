---
- name: Fail when grafana admin password isn't set
  fail:
    msg: "Please specify grafana admin password (grafana_security.admin_password)"
  when:
    - grafana_security.admin_password is undefined or grafana_security.admin_password | length == 0

# Grafana admin password change is only available through the grafana-cli
- name: Change admin assword using grafana-cli
  shell: grafana-cli admin reset-admin-password "{{ grafana_security.admin_password }}"
