---
# If state file exists, it means upgrade has been started by the previous play and should be continued
- name: OPS | Check if upgrade state file exists
  stat:
    path: "{{ opensearch.upgrade_state_file_path }}"
    get_attributes: false
    get_checksum: false
    get_mime: false
  register: stat_upgrade_state_file

- name: OPS | Upgrade Elasticsearch and ODFE plugins (part 2/2)
  include_tasks: opensearch/upgrade-opensearch-02.yml
  when: stat_upgrade_state_file.stat.exists
