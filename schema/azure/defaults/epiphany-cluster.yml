---
kind: epiphany-cluster
title: Epiphany cluster Config
provider: azure
name: default
specification:
  name: SET_BY_AUTOMATION
  admin_user:
    name: <INPUT_ADMIN_USER>
    key_path: /home/epiuser/.ssh/id_rsa
  cloud:
    subscription_name: <INPUT_SUBSCRIPTION_NAME>
    k8s_as_cloud_service: True # AKS
    vnet_address_pool: 10.58.10.0/24
    use_public_ips: False # When not using public IPs you have to provide connectivity via private IPs (VPN)
    use_service_principal: False
    service_principal: # todo change it to get service principal credentials from vault
      appId: ''
      password: ''
      tenant: ''
      subscriptionId: ''
    region: West Europe
    network:
      use_network_security_groups: True
    default_os_image: default
    hostname_domain_extension: '' # Domain name that will be added to every machines hostname with a . seperator
  components:
    kafka:
      count: 3
      availability_set: kafka
      alt_component_name: ''
      machine: kafka-machine
      configuration: default
      subnets:
        - address_pool: 10.58.10.32/27 # 10.58.x.33 - 10.58.x.62
          service_endpoints: []
    logging:
      count: 3
      availability_set: logging
      alt_component_name: ''
      machine: logging-machine
      configuration: default
      subnets:
        - address_pool: 10.58.10.64/27 # 10.58.x.65 - 10.58.x.94
          service_endpoints: []
    monitoring:
      count: 1
      alt_component_name: ''
      machine: monitoring-machine
      configuration: default
      subnets:
        - address_pool: 10.58.10.96/27 # 10.58.x.97 - 10.58.x.126
          service_endpoints: []
    repository:
      count: 0 # by default the 'repository' role is mapped to the 'monitoring' component to reduce costs
      alt_component_name: ''
      machine: repository-machine
      configuration: default
      subnets:
        - address_pool: 10.58.10.128/27 # 10.58.x.129 - 10.58.x.158
          service_endpoints: []
    single_machine:
      count: 0
      alt_component_name: ''
      machine: single-machine
      configuration: default
      subnets:
        - address_pool: 10.58.10.160/27
          service_endpoints: []
